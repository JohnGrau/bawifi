jQuery.extendIf=function(b,d){if(b&&d){for(var a in d){if(typeof b[a]=="undefined"){b[a]=d[a]}}}return b};if(typeof(Ext)=="undefined"){jQuery.extend(Function.prototype,{createCallback:function(){var a=arguments;var b=this;return function(){return b.apply(window,a)}},createDelegate:function(c,b,a){var d=this;return function(){var f=b||arguments;if(a===true){f=Array.prototype.slice.call(arguments,0);f=f.concat(b)}else{if(typeof a=="number"){f=Array.prototype.slice.call(arguments,0);var e=[a,0].concat(b);Array.prototype.splice.apply(f,e)}}return d.apply(c||window,f)}},defer:function(c,e,b,a){var d=this.createDelegate(e,b,a);if(c){return setTimeout(d,c)}d();return 0},createSequence:function(b,a){if(typeof b!="function"){return this}var c=this;return function(){var d=c.apply(this||window,arguments);b.apply(a||this||window,arguments);return d}},createInterceptor:function(b,a){if(typeof b!="function"){return this}var c=this;return function(){b.target=this;b.method=c;if(b.apply(a||this||window,arguments)===false){return}return c.apply(this||window,arguments)}}});jQuery.extendIf(String,{escape:function(a){return a.replace(/('|\\)/g,"\\$1")},leftPad:function(d,b,c){var a=new String(d);if(!c){c=" "}while(a.length<b){a=c+a}return a.toString()},format:function(b){var a=Array.prototype.slice.call(arguments,1);return b.replace(/\{(\d+)\}/g,function(c,d){return a[d]})}})}String.prototype.isInteger=function(){return !isNaN(parseInt(this))};String.prototype.isFloat=function(){return !isNaN(parseFloat(this))};String.prototype.toggle=function(b,a){return this==b?a:b};String.prototype.trim=function(){var a=/^\s+|\s+$/g;return function(){return this.replace(a,"")}}();String.prototype.translate=function(d,c){if(!(d.length&&c.length)||d.length!=c.length){return this}var b=this;for(var a=0;a<d.length;a++){if(typeof(d)=="string"){b=b.replace(new RegExp(d.charAt(a),"g"),c.charAt(a))}else{b=b.replace(new RegExp(d[a],"g"),c[a])}}return b};String.prototype.isDigit=function(){return/^\d+$/.test(this)};String.prototype.removeWords=function(e){var d=this.split(" ");var c=new Array();for(var b=0;b<d.length;b++){c.push(d[b]);for(var a=0;a<e.length;a++){if(c[b]==e[a]){c.pop();break}}}return c.join(" ")};jQuery.extendIf(Number.prototype,{constrain:function(b,a){return Math.min(Math.max(this,b),a)},isInteger:function(){return !isNaN(parseInt(this))},isFloat:function(){return !isNaN(parseFloat(this))}});jQuery.extendIf(Array.prototype,{indexOf:function(c){for(var b=0,a=this.length;b<a;b++){if(this[b]==c){return b}}return -1},removeObject:function(b){var a=this.indexOf(b);if(a!=-1){this.splice(a,1)}return this},binarySearch:function binarySearch(f,b){var a=0,e=this.length-1,c,d;while(a<=e){c=parseInt((a+e)/2,10);d=b(this[c],f);if(d<0){a=c+1;continue}if(d>0){e=c-1;continue}return c}return -1},inject:function(c,b){for(var a=0;a<this.length;a++){c=b(c,this[a],a)}return c},map:function(d,c){var a=new Array(this.length);for(var b=0,e=this.length;b<e;b++){if(b in this){a[b]=d.call(c,this[b],b,this)}}return a},intersect:function(){if(!arguments.length){return[]}var e=this;var d=a2=null;var h=0;while(h<arguments.length){d=[];a2=arguments[h];var c=e.length;var b=a2.length;for(var g=0;g<c;g++){for(var f=0;f<b;f++){if(e[g]===a2[f]){d.push(e[g])}}}e=d;h++}return d.unique()},unique:function(){var c=[];var b=this.length;for(var e=0;e<b;e++){for(var d=e+1;d<b;d++){if(this[e]===this[d]){d=++e}}c.push(this[e])}return c}});Date.prototype.getElapsed=function(a){return Math.abs((a||new Date()).getTime()-this.getTime())};if(typeof(usig)=="undefined"){usig={}}usig.debug=function(a){if(window.console&&window.console.log){window.console.log(a)}};if(typeof(usig)=="undefined"){usig={}}jQuery.extendIf(usig,{loadingJs:[],loadingJsListeners:{},__callLoadJsListeners:function(b){for(var c=0,a=usig.loadingJsListeners[b].length;c<a;c++){usig.loadingJsListeners[b][c]()}},loadJs:function(b,e){if(usig.loadingJs.indexOf(b)<0){usig.loadingJs.push(b);usig.loadingJsListeners[b]=(typeof(e)=="function")?[e]:[];var a=document.createElement("script"),c=document.getElementsByTagName("head")[0],d=false;a.onload=a.onreadystatechange=function(){if((a.readyState&&a.readyState!=="complete"&&a.readyState!=="loaded")||d){return false}a.onload=a.onreadystatechange=null;d=true;usig.__callLoadJsListeners(b)};a.src=b;c.insertBefore(a,c.firstChild)}else{usig.loadingJsListeners[b].push(e)}},loadCss:function(a){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);if(typeof b!="undefined"){document.getElementsByTagName("head")[0].appendChild(b)}},removeJs:function(a){var c=document.getElementsByTagName("script");for(var b=c.length;b>=0;b--){if(c[b]&&c[b].getAttribute("src")!=null&&c[b].getAttribute("src").indexOf(a)!=-1){c[b].parentNode.removeChild(c[b])}}},removeCss:function(a){var c=document.getElementsByTagName("link");for(var b=c.length;b>=0;b--){if(c[b]&&c[b].getAttribute("href")!=null&&c[b].getAttribute("href").indexOf(a)!=-1){c[b].parentNode.removeChild(c[b])}}},Animator:function(c,d,e,f){var b=0;function a(){if(c.length>b){d(c[b]);b++;setTimeout(a,e)}else{if(typeof(f)=="function"){f()}}}this.stop=function(){b=c.length+1};a()},parseUri:function(e){var a=["source","protocol","authority","domain","port","path","directoryPath","fileName","query","anchor"],b=new RegExp("^(?:([^:/?#.]+):)?(?://)?(([^:/?#]*)(?::(\\d*))?)((/(?:[^?#](?![^?#/]*\\.[^?#/.]+(?:[\\?#]|$)))*/?)?([^?#/]*))?(?:\\?([^#]*))?(?:#(.*))?").exec(e),d={};for(var c=0;c<10;c++){d[a[c]]=(b[c]?b[c]:"")}if(d.directoryPath.length>0){d.directoryPath=d.directoryPath.replace(/\/?$/,"/")}return d},registeredSuggesters:{},registerSuggester:function(a,b){usig.registeredSuggesters[a]=b},createSuggester:function(b,a){if(typeof(usig.registeredSuggesters[b])!="function"){throw"Suggester "+b+" is not registered.";return null}return new usig.registeredSuggesters[b](a)}});(function(d){var b=function(o){return o!==undefined&&o!==null},n=function(q,o,p){b(q)&&q.apply(o,p)},e=function(o){setTimeout(o,0)},f="",a="&",l="?",m="success",g="error",j=d("head"),h={},c={callback:"C",url:location.href},k=function(t){t=d.extend({},c,t);var s=t.beforeSend,B=0;t.abort=function(){B=1};if(b(s)&&(s(t,t)===false||B)){return t}var r=t.success,p=t.complete,w=t.error,D=t.dataFilter,H=t.callbackParameter,x=t.callback,E=t.cache,o=t.pageCache,u=t.url,J=t.data,y=t.timeout,A,I,G,F;u=b(u)?u:f;J=b(J)?((typeof J)=="string"?J:d.param(J)):f;b(H)&&(J+=(J==f?f:a)+escape(H)+"=?");!E&&!o&&(J+=(J==f?f:a)+"_"+(new Date()).getTime()+"=");A=u.split(l);if(J!=f){I=J.split(l);F=A.length-1;F&&(A[F]+=a+I.shift());A=A.concat(I)}G=A.length-2;G&&(A[G]+=x+A.pop());var q=A.join(l),C=function(K){b(D)&&(K=D.apply(t,[K]));n(r,t,[K,m]);n(p,t,[t,m])},z=function(K){n(w,t,[t,K]);n(p,t,[t,K])},v=h[q];if(o&&b(v)){e(function(){b(v.s)?C(v.s):z(g)});return t}e(function(){if(B){return}var K=d("<iframe />").appendTo(j),M=K[0],O=M.contentWindow||M.contentDocument,Q=O.document,L,R,S=function(T,U){L();z(b(U)?U:g)},N=function(U){O[U]=undefined;try{delete O[U]}catch(T){}},P=x=="E"?"X":"E";if(!b(Q)){Q=O;O=Q.getParentNode()}Q.open();O[x]=function(T){B=1;o&&(h[q]={s:T});e(function(){L();C(T)})};O[P]=function(T){(!T||T=="complete")&&!B++&&e(S)};t.abort=L=function(){clearTimeout(R);Q.open();N(P);N(x);Q.write(f);Q.close();K.remove()};Q.write(['<html><head><script src="',q,'" onload="',P,'()" onreadystatechange="',P,'(this.readyState)"><\/script></head><body onload="',P,'()"></body></html>'].join(f));Q.close();y>0&&(R=setTimeout(function(){!B&&S(f,"timeout")},y))});return t};k.setup=function(o){d.extend(c,o)};d.jsonp=k})(jQuery);if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function(){var a=false,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;jQuery.Class=function(){};jQuery.Class.create=function(g){var f=this.prototype;a=true;var e=new this();a=false;for(var d in g){e[d]=typeof g[d]=="function"&&typeof f[d]=="function"&&b.test(g[d])?(function(h,j){return function(){var l=this._super;this._super=f[h];var k=j.apply(this,arguments);this._super=l;return k}})(d,g[d]):g[d]}function c(){if(!a&&c.prototype.init){return c.prototype.init.apply(this,arguments)}}c.prototype=e;c.prototype.constructor=c;c.extend=arguments.callee;return c}})();if(typeof(usig)=="undefined"){usig={}}usig.AjaxComponent=(function(a){return jQuery.Class.create({init:function(e,b,d){this.name=e;var c=window.location.host==usig.parseUri(b).authority?"json":"jsonp";this.defaultParams={type:"GET",url:b,dataType:c};jQuery.jsonp.setup({callbackParameter:"callback",pageCache:true,dataFilter:function(f){return JSON.parse(JSON.stringify(f))}});this.opts=a.extend({},usig.AjaxComponent.defaults,d);if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") dataType: "+c)}},mkRequest:function(g,l,j,d){var c=null,h=0;function b(n,o){clearTimeout(c);if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") Ajax Request Success")}if(typeof(this.opts.afterServerResponse)=="function"){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") calling afterServerResponse")}this.opts.afterServerResponse()}o(n)}function f(n,o){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") Ajax Request Error")}if(h>=this.opts.maxRetries){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") Ajax Request Max Errors Reached")}clearTimeout(c);o(n)}else{if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") Ajax Request Error. Retrying... ("+h+")")}}}function k(n,p){if(n!=null&&n.readyState!=0&&n.readyState!=4){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") Aborting request...")}n.abort();if(typeof(this.opts.afterAbort)=="function"){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") calling afterAbort")}this.opts.afterAbort()}if(this.opts.maxRetries>h){h++;var o=(p.dataType=="jsonp")?a.jsonp(p):a.ajax(p);if(typeof(this.opts.afterRetry)=="function"){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") calling afterRetry")}this.opts.afterRetry()}if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") Retrying request... ("+h+")")}c=setTimeout(k.createDelegate(this,[o,m]),this.opts.serverTimeout)}else{if(this.opts.debug){usig.debug("ERROR: Se alcanzo el maximo numero de reintentos al servidor sin exito.")}if(typeof(p.error)=="function"){p.error("Se produjo un error al intentar acceder al servidor: "+p.url)}}}}if(typeof(l)!="function"){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") success tiene que ser una función que acepte como parámetro el dato solicitado porque puede no estar inmediatamente disponible.")}return}if(typeof(j)!="undefined"&&typeof(j)!="function"){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") error tiene que ser una función.")}return}var m=a.extend(true,{},this.defaultParams,{success:b.createDelegate(this,[l],1),error:f.createDelegate(this,[j],1),data:g});if(d){m.url=d}var e=(m.dataType=="jsonp")?a.jsonp(m):a.ajax(m);if(this.opts.debug){usig.debug(m.dataType+" request...")}if(typeof(this.opts.afterServerRequest)=="function"){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") calling afterServerRequest")}this.opts.afterServerRequest()}if(this.opts.serverTimeout>0){c=setTimeout(k.createDelegate(this,[e,m]),this.opts.serverTimeout)}return e},setOptions:function(b){this.opts=a.extend({},this.opts,b)},getOptions:function(){return this.opts}})})(jQuery);usig.AjaxComponent.defaults={debug:false,serverTimeout:30000,maxRetries:1};if(typeof(usig)=="undefined"){usig={}}if(typeof(usig.defaults)=="undefined"){usig.defaults={}}usig.TripTemplate=function(b,a){this.index=b;this.color=a;this.cls="trip_"+b};usig.defaults.Recorridos={debug:false,trackVisits:true,piwikBaseUrl:"http://usig.buenosaires.gov.ar/piwik/",piwikSiteId:4,server:"http://recorridos.usig.buenosaires.gob.ar/2.0/",serverTimeout:8000,maxRetries:5,serverOptions:{tipo:"transporte",gml:true,precargar:3,opciones_caminata:800,opciones_medios_colectivo:true,opciones_medios_subte:true,opciones_medios_tren:true,opciones_prioridad:"avenidas",opciones_incluir_autopistas:true},colorTemplates:[new usig.TripTemplate(1,"#8F58C7"),new usig.TripTemplate(2,"#E34900"),new usig.TripTemplate(3,"#C3E401"),new usig.TripTemplate(4,"#F9B528"),new usig.TripTemplate(5,"#D71440"),new usig.TripTemplate(6,"#007baf"),new usig.TripTemplate(7,"#495a78"),new usig.TripTemplate(8,"#b56c7d"),new usig.TripTemplate(9,"#669966"),new usig.TripTemplate(10,"#ff3300")]};usig.Recorridos=(function(a){return new (usig.AjaxComponent.extend({lastRequest:null,init:function(c){var d=a.extend({},usig.defaults.Recorridos,c);this._super("Recorridos",usig.defaults.Recorridos.server,d);var b=function(e){try{var g=Piwik.getTracker(d.piwikBaseUrl+"piwik.php",e);g.trackPageView();g.enableLinkTracking()}catch(f){}};if(usig.Recorridos&&d.trackVisits){if(typeof(Piwik)=="undefined"){usig.loadJs(d.piwikBaseUrl+"piwik.js",b.createDelegate(this,[d.piwikSiteId]))}else{b(d.piwikSiteId)}}},getUbicacion:function(b){var c={coordenadas:{x:0,y:0},codigo_calle:0,altura:0,codigo_calle2:0};if(b.x!=undefined&&b.y!=undefined){c.coordenadas=b}if(usig.Direccion&&b instanceof usig.Direccion){if(b.getTipo()==usig.Direccion.CALLE_Y_CALLE){c.codigo_calle2=b.getCalleCruce().codigo}c.coordenadas=b.getCoordenadas();c.codigo_calle=b.getCalle().codigo;c.altura=b.getAltura()}if(usig.inventario&&usig.inventario.Objeto&&b instanceof usig.inventario.Objeto){if(b.direccionAsociada){c.coordenadas=b.direccionAsociada.getCoordenadas();c.codigo_calle=b.direccionAsociada.getCalle().codigo;c.altura=b.direccionAsociada.getAltura()}else{c.coordenadas=b.ubicacion.getCentroide()}}if(usig.DireccionMapabsas&&b instanceof usig.DireccionMapabsas){if(b.tipo==usig.Direccion.CALLE_Y_CALLE){c.codigo_calle2=b.cod_calle_cruce}c.codigo_calle=b.cod;c.altura=b.alt}return c},onBuscarRecorridosSuccess:function(d,e){var b=[],c=this.opts.colorTemplates;if(this.opts.debug){usig.debug("usig.Recorridos onBuscarRecorridosSuccess")}a.each(d.planning,function(f,g){b.push(new usig.Recorrido(JSON.parse(g),{template:c[f]}))});if(typeof(e)=="function"){e(b)}},loadTripPlan:function(c,d,b){this.lastRequest=this.mkRequest(c,d,b,this.opts.server+"load_plan")},consultarRecorridos:function(d,c,e,b){this.lastRequest=this.mkRequest(d,e,b,this.opts.server+"recorridos_"+c)},InfoTransporte:function(c,d,b){this.lastRequest=this.mkRequest(c,d,b,this.opts.server+"info_transporte/")},buscarRecorridos:function(e,d,h,c,b){var f=a.extend({},this.opts.serverOptions,b);var g=this.getUbicacion(e);if(g.coordenadas){f.origen=g.coordenadas.x+","+g.coordenadas.y}f.origen_calles2=g.codigo_calle2;f.origen_calles=g.codigo_calle;f.origen_calle_altura=g.altura;var j=this.getUbicacion(d);if(j.coordenadas){f.destino=j.coordenadas.x+","+j.coordenadas.y}f.destino_calles2=j.codigo_calle2;f.destino_calles=j.codigo_calle;f.destino_calle_altura=j.altura;this.lastRequest=this.mkRequest(f,this.onBuscarRecorridosSuccess.createDelegate(this,[h],1),c,this.opts.server+"consultar_recorridos")},cargarPlanRecorrido:function(f,e,c,b){var d=a.extend({},this.opts.serverOptions,b);d.trip_id=f;d.tipo="loadplan";this.lastRequest=this.mkRequest(d,e,c,this.opts.server+"consultar_recorridos")},transportesCercanos:function(e,f,c){var b=this.getUbicacion(e);var d={x:b.coordenadas.x,y:b.coordenadas.y};this.lastRequest=this.mkRequest(d,f,c,this.opts.server+"info_transporte/")}}))})(jQuery);if(typeof(usig)=="undefined"){usig={}}if(typeof(usig.Recorrido)=="undefined"){usig.Recorrido=(function(a){return function(q,g){var p=0,e=0,o,s,d,j,c,u,l,h="Sin datos",v="Sin datos",r=[],f=0,m=a.extend({},usig.Recorrido.defaults,g);getServiceIcon=function(w){var x="";if(w==0){x="recorrido_pie"}if(w==1){x="recorrido_subte"}if(w==2){x="recorrido_tren"}if(w==3){x="recorrido_colectivo"}return'<img src="'+m.icons[x]+'" width="20" height="20">'};function t(){var w=[];v="";if(d=="transporte_publico"){a.each(j,function(y,z){if(z.type=="Board"){if(!z.any_trip&&z.service_type!=1){if(z.trip_description!=""){var x="Ramales: "+z.trip_description.replace("$",", ");v+=getServiceIcon(z.service_type)+" "+z.service+'  <span class="ramales" title="'+x+'">(*)</span>';w.push(z.service+" ("+x+")")}else{v+=getServiceIcon(z.service_type)+" "+z.service+' <span class="ramales" title="'+m.texts.hayRamales+'">(*)  </span>';w.push(z.service+" ("+m.texts.hayRamales+")")}}else{v+=getServiceIcon(z.service_type)+" "+z.service+"  ";w.push(z.service)}}});h=w.join(", ")}else{if(d=="walk"){h=m.texts.descWalk;a.each(j,function(x,y){if(y.type!=undefined&&y.type=="StartWalking"){v+='<img src="'+m.icons.recorrido_pie+'" width="20" height="20"> '+h}})}else{if(d=="car"){h=m.texts.descCar;a.each(j,function(x,y){if(y.type!=undefined&&y.type=="StartDriving"){v+='<img src="'+m.icons.recorrido_auto+'" width="20" height="20"> '+h}})}}}}function n(){if(d=="transporte_publico"){var A=null;var y=false;var E=0;var w=null;var C=null;for(i=0;i<c.length;i++){var G=c[i];if(G.type!=undefined){if(G.type=="StartWalking"){y=true;if(i==0){A="Caminar desde "+c[i+1].name+" "+c[i+1].from}else{A="Caminar desde "+c[i-1].stop_description}C="pie"}else{if(G.type=="FinishWalking"){if(A){A+=" hasta destino.";r.push({text:A,type:C});A=null;C=null}y=false}else{if(G.type=="Board"){var x=y;if(y){if(G.service_type=="3"){A+=" hasta "+G.stop_description}else{A+=" hasta la estaci&oacute;n "+G.stop_name+" en "+G.stop_description}if(!(A.charAt(A.length-1)==".")){A+="."}r.push({text:A,type:C});y=false;A=null;C=null}if(G.service_type=="1"){A='Tomar el <span class="transport">SUBTE '+G.service.toUpperCase()+"</span> ";if(E>0){A+=" en la estaci&oacute;n "+G.stop_name}C="subte"}else{if(G.service_type=="3"){if(G.trip_description!=""&&!G.any_trip){w=" (Ramales: "+G.trip_description.replace("$",", ")+")"}else{w=(!G.any_trip)?" ("+m.texts.hayRamales+")":""}A='Tomar el <span class="transport">COLECTIVO '+G.service+w+" </span> ";C="colectivo"}else{if(G.service_type=="2"){if(G.trip_description!=""&&!G.any_trip){w=" ("+G.trip_description.replace("$"," y ")+")"}else{w=(!G.any_trip)?" ("+m.texts.hayRamales+")":""}A='Tomar el <span class="transport">TREN '+G.service.toUpperCase()+w+"</span> ";C="tren";if(E>0){A+=" en la estaci&oacute;n "+G.stop_name}}}}if(!x){A+=" en "+G.stop_description}E+=1}else{if(G.type=="Alight"){if(G.service_type!=undefined&&(G.service_type=="2"||G.service_type=="1")){A+=" y bajar en la estaci&oacute;n "+G.stop_name}else{A+=" y bajar en "+G.stop_description}if(!(A.charAt(A.length-1)==".")){A+="."}r.push({text:A,type:C});A=null;C=null}else{if(G.type=="Bus"){}else{if(G.type=="SubWay"){}else{if(G.type=="SubWayConnection"){r.push({text:A,type:C});A='Combinar con el <span class="transport">SUBTE '+G.service_to.toUpperCase()+"</span> en estaci&oacute;n "+G.stop;C="subte"}else{if(G.type=="Street"){}}}}}}}}}}}else{if(d=="walk"){var z=new Array();var B=0;for(i=0;i<c.length;i++){var G=c[i];if(G.type!=undefined){var F=null;if(G.type=="Street"){B++;F=G.name+" ";if(typeof(G.from)!="undefined"){F+=G.from}if(typeof(G.to)!="undefined"){F+=" - "+G.to}z.push({type:"walk",text:F,distance:G.distance,index:B,id:G.id})}}}r=z}else{if(d=="car"){z=new Array();B=0;var F;for(i=0;i<c.length;i++){var G=c[i];if(G.type!=undefined){var D;if(G.type=="Street"){B++;if(G.indicacion_giro!="0"&&G.indicacion_giro!="1"&&G.indicacion_giro!="2"){F="Ir desde ";D="seguir"}else{if(G.indicacion_giro=="0"){F="Seguir por ";D="seguir"}else{if(G.indicacion_giro=="1"){F="Doblar a la izquierda en ";D="izquierda"}else{if(G.indicacion_giro=="2"){F="Doblar a la derecha en ";D="derecha"}}}}F+=G.name+" ";if(G.from){F+=G.from}if(G.to){F+=" hasta el "+G.to}z.push({text:F,turn_indication:D,index:B,distance:G.distance,type:"car",id:G.id})}}}r=z}}}}function b(w){try{p=w.id;e=w.tiempo;o=w.origen;s=w.destino;d=w.type;j=w.summary;f=w.traveled_distance;u=a.extend({},w);u.options=m;t();k(w)}catch(x){usig.debug(x)}}function k(w,x){if(!c&&w.plan){c=w.plan;u.plan=w.plan;n()}if(typeof(x)=="function"){x(r,c)}}this.load=function(w){b(w)};this.toString=function(){return h};this.toHtmlString=function(){return v};this.getTime=function(){return e};this.getTraveledDistance=function(){return f};this.getTimeString=function(){time="";if(e>60){hs=Math.round(e/60);mins=e%60;time+=hs+(hs>1?"hs ":"h ")+mins+" '"}else{time+=e+" '"}return time};this.getPlan=function(x,w,y){if(!c){usig.Recorridos.cargarPlanRecorrido(p,k.createDelegate(this,[x],1),w,y)}else{if(typeof(x)=="function"){x(c)}}return c};this.getDetalle=function(x,w,y){if(!c){if(u.plan){k(u,x)}else{usig.Recorridos.cargarPlanRecorrido(p,k.createDelegate(this,[x],1),w,y)}}else{if(typeof(x)=="function"){x(r)}}};this.getId=function(){return p};this.getTemplate=function(){return m.template};this.getColor=function(){return m.template.color};this.getTipo=function(){return d};this.setColor=function(w){m.template.color=w};this.getCoordenadaOrigen=function(){return o};this.getCoordenadaDestino=function(){return s};this.toJson=function(){return u};this.isEqual=function(w){return d==w.getTipo()&&h==w.toString()&&o==w.getCoordenadaOrigen()&&s==w.getCoordenadaDestino()};if(q){b(q)}}})(jQuery);usig.Recorrido.fromObj=function(a){return new usig.Recorrido(a,a.options)};usig.Recorrido.defaults={icons:{recorrido_pie:"http://mapa.buenosaires.gob.ar/images/recorrido_pie20x20.png",recorrido_subte:"http://mapa.buenosaires.gob.ar/images/recorrido_subte20x20.png",recorrido_tren:"http://mapa.buenosaires.gob.ar/images/recorrido_tren20x20.png",recorrido_colectivo:"http://mapa.buenosaires.gob.ar/images/recorrido_colectivo20x20.png",recorrido_auto:"http://mapa.buenosaires.gob.ar/images/recorrido_auto20x20.png"},template:new usig.TripTemplate(1,"#8F58C7"),texts:{descWalk:"Recorrido a pie",descCar:"Recorrido en auto",hayRamales:"No todos los ramales conducen a destino"}}};